# Snapshot report for `__tests__/core.js`

The actual snapshot is saved in `core.js.snap`.

Generated by [AVA](https://ava.li).

## compiling an document with a custom element gives replaces with element

> Snapshot 1

    `<html><head><title></title></head><body><div id="belte-0">␊
      <span class="svelte-1o05y1e">Hello, </span>␊
      <span class="caption svelte-1kxi60c">Jeff</span>␊
      <p>Count: 0</p>␊
      <button>+1</button>␊
    </div><div id="belte-1">␊
      <span class="svelte-1o05y1e">Hello, </span>␊
      <span class="caption svelte-1kxi60c">Jeff</span>␊
      <p>Count: 0</p>␊
      <button>+1</button>␊
    </div><div id="belte-2">␊
      <span class="svelte-w26vqd">The time is: 18:22:59</span>␊
    	<button>update</button>␊
    </div><script>/* CustomElement.html generated by Svelte v2.16.1 */␊
    import Plain from "./PlainElement.html";␊
    ␊
    function data() {␊
    			return {␊
    				name: "Jeff", ␊
        count: 0␊
    			};␊
    		};␊
    ␊
    function create_main_fragment(component, ctx) {␊
    	var div, text0, span, text1, text2, p, text3, text4, text5, button, text6;␊
    ␊
    	var plain = new Plain({␊
    		root: component.root,␊
    		store: component.store␊
    	});␊
    ␊
    	function click_handler(event) {␊
    		component.set({ count: ctx.count + 1 });␊
    	}␊
    ␊
    	return {␊
    		c() {␊
    			div = createElement("div");␊
    			plain._fragment.c();␊
    			text0 = createText("\\n  ");␊
    			span = createElement("span");␊
    			text1 = createText(ctx.name);␊
    			text2 = createText("\\n  ");␊
    			p = createElement("p");␊
    			text3 = createText("Count: ");␊
    			text4 = createText(ctx.count);␊
    			text5 = createText("\\n  ");␊
    			button = createElement("button");␊
    			text6 = createText("+1");␊
    			this.h()␊
    		},␊
    ␊
    		l(nodes) {␊
    			div = claimElement(nodes, "DIV", {}, false);␊
    			var div_nodes = children(div);␊
    ␊
    			plain._fragment.l(div_nodes);␊
    			text0 = claimText(div_nodes, "\\n  ");␊
    ␊
    			span = claimElement(div_nodes, "SPAN", { class: true }, false);␊
    			var span_nodes = children(span);␊
    ␊
    			text1 = claimText(span_nodes, ctx.name);␊
    			span_nodes.forEach(detachNode);␊
    			text2 = claimText(div_nodes, "\\n  ");␊
    ␊
    			p = claimElement(div_nodes, "P", {}, false);␊
    			var p_nodes = children(p);␊
    ␊
    			text3 = claimText(p_nodes, "Count: ");␊
    			text4 = claimText(p_nodes, ctx.count);␊
    			p_nodes.forEach(detachNode);␊
    			text5 = claimText(div_nodes, "\\n  ");␊
    ␊
    			button = claimElement(div_nodes, "BUTTON", {}, false);␊
    			var button_nodes = children(button);␊
    ␊
    			text6 = claimText(button_nodes, "+1");␊
    			button_nodes.forEach(detachNode);␊
    			div_nodes.forEach(detachNode);␊
    			this.h();␊
    		},␊
    ␊
    		h() {␊
    			span.className = "caption svelte-1kxi60c";␊
    			addListener(button, "click", click_handler);␊
    		},␊
    ␊
    		m(target, anchor) {␊
    			insert(target, div, anchor);␊
    			plain._mount(div, null);␊
    			append(div, text0);␊
    			append(div, span);␊
    			append(span, text1);␊
    			append(div, text2);␊
    			append(div, p);␊
    			append(p, text3);␊
    			append(p, text4);␊
    			append(div, text5);␊
    			append(div, button);␊
    			append(button, text6);␊
    		},␊
    ␊
    		p(changed, _ctx) {␊
    			ctx = _ctx;␊
    			if (changed.name) {␊
    				setData(text1, ctx.name);␊
    			}␊
    ␊
    			if (changed.count) {␊
    				setData(text4, ctx.count);␊
    			}␊
    		},␊
    ␊
    		d(detach) {␊
    			if (detach) {␊
    				detachNode(div);␊
    			}␊
    ␊
    			plain.destroy();␊
    			removeListener(button, "click", click_handler);␊
    		}␊
    	};␊
    }␊
    ␊
    function CustomElement(options) {␊
    	init(this, options);␊
    	this._state = assign(data(), options.data);␊
    	this._intro = true;␊
    ␊
    	this._fragment = create_main_fragment(this, this._state);␊
    ␊
    	if (options.target) {␊
    		var nodes = children(options.target);␊
    		options.hydrate ? this._fragment.l(nodes) : this._fragment.c();␊
    		nodes.forEach(detachNode);␊
    		this._mount(options.target, options.anchor);␊
    ␊
    		flush(this);␊
    	}␊
    }␊
    ␊
    assign(CustomElement.prototype, {␊
     	destroy: destroy,␊
     	get: get,␊
     	fire: fire,␊
     	on: on,␊
     	set: set,␊
     	_set: _set,␊
     	_stage: _stage,␊
     	_mount: _mount,␊
     	_differs: _differs␊
     });␊
    ␊
    CustomElement.prototype._recompute = noop;␊
    ␊
    function createElement(name) {␊
    	return document.createElement(name);␊
    }␊
    ␊
    function createText(data) {␊
    	return document.createTextNode(data);␊
    }␊
    ␊
    function claimElement (nodes, name, attributes, svg) {␊
    	for (var i = 0; i < nodes.length; i += 1) {␊
    		var node = nodes[i];␊
    		if (node.nodeName === name) {␊
    			for (var j = 0; j < node.attributes.length; j += 1) {␊
    				var attribute = node.attributes[j];␊
    				if (!attributes[attribute.name]) node.removeAttribute(attribute.name);␊
    			}␊
    			return nodes.splice(i, 1)[0]; // TODO strip unwanted attributes␊
    		}␊
    	}␊
    ␊
    	return svg ? createSvgElement(name) : createElement(name);␊
    }␊
    ␊
    function children (element) {␊
    	return Array.from(element.childNodes);␊
    }␊
    ␊
    function claimText (nodes, data) {␊
    	for (var i = 0; i < nodes.length; i += 1) {␊
    		var node = nodes[i];␊
    		if (node.nodeType === 3) {␊
    			node.data = data;␊
    			return nodes.splice(i, 1)[0];␊
    		}␊
    	}␊
    ␊
    	return createText(data);␊
    }␊
    ␊
    function detachNode(node) {␊
    	node.parentNode.removeChild(node);␊
    }␊
    ␊
    function addListener(node, event, handler, options) {␊
    	node.addEventListener(event, handler, options);␊
    }␊
    ␊
    function insert(target, node, anchor) {␊
    	target.insertBefore(node, anchor);␊
    }␊
    ␊
    function append(target, node) {␊
    	target.appendChild(node);␊
    }␊
    ␊
    function setData(text, data) {␊
    	text.data = '' + data;␊
    }␊
    ␊
    function removeListener(node, event, handler, options) {␊
    	node.removeEventListener(event, handler, options);␊
    }␊
    ␊
    function init(component, options) {␊
    	component._handlers = blankObject();␊
    	component._slots = blankObject();␊
    	component._bind = options._bind;␊
    	component._staged = {};␊
    ␊
    	component.options = options;␊
    	component.root = options.root || component;␊
    	component.store = options.store || component.root.store;␊
    ␊
    	if (!options.root) {␊
    		component._beforecreate = [];␊
    		component._oncreate = [];␊
    		component._aftercreate = [];␊
    	}␊
    }␊
    ␊
    function assign(tar, src) {␊
    	for (var k in src) tar[k] = src[k];␊
    	return tar;␊
    }␊
    ␊
    function flush(component) {␊
    	component._lock = true;␊
    	callAll(component._beforecreate);␊
    	callAll(component._oncreate);␊
    	callAll(component._aftercreate);␊
    	component._lock = false;␊
    }␊
    ␊
    function destroy(detach) {␊
    	this.destroy = noop;␊
    	this.fire('destroy');␊
    	this.set = noop;␊
    ␊
    	this._fragment.d(detach !== false);␊
    	this._fragment = null;␊
    	this._state = {};␊
    }␊
    ␊
    function get() {␊
    	return this._state;␊
    }␊
    ␊
    function fire(eventName, data) {␊
    	var handlers =␊
    		eventName in this._handlers && this._handlers[eventName].slice();␊
    	if (!handlers) return;␊
    ␊
    	for (var i = 0; i < handlers.length; i += 1) {␊
    		var handler = handlers[i];␊
    ␊
    		if (!handler.__calling) {␊
    			try {␊
    				handler.__calling = true;␊
    				handler.call(this, data);␊
    			} finally {␊
    				handler.__calling = false;␊
    			}␊
    		}␊
    	}␊
    }␊
    ␊
    function on(eventName, handler) {␊
    	var handlers = this._handlers[eventName] || (this._handlers[eventName] = []);␊
    	handlers.push(handler);␊
    ␊
    	return {␊
    		cancel: function() {␊
    			var index = handlers.indexOf(handler);␊
    			if (~index) handlers.splice(index, 1);␊
    		}␊
    	};␊
    }␊
    ␊
    function set(newState) {␊
    	this._set(assign({}, newState));␊
    	if (this.root._lock) return;␊
    	flush(this.root);␊
    }␊
    ␊
    function _set(newState) {␊
    	var oldState = this._state,␊
    		changed = {},␊
    		dirty = false;␊
    ␊
    	newState = assign(this._staged, newState);␊
    	this._staged = {};␊
    ␊
    	for (var key in newState) {␊
    		if (this._differs(newState[key], oldState[key])) changed[key] = dirty = true;␊
    	}␊
    	if (!dirty) return;␊
    ␊
    	this._state = assign(assign({}, oldState), newState);␊
    	this._recompute(changed, this._state);␊
    	if (this._bind) this._bind(changed, this._state);␊
    ␊
    	if (this._fragment) {␊
    		this.fire("state", { changed: changed, current: this._state, previous: oldState });␊
    		this._fragment.p(changed, this._state);␊
    		this.fire("update", { changed: changed, current: this._state, previous: oldState });␊
    	}␊
    }␊
    ␊
    function _stage(newState) {␊
    	assign(this._staged, newState);␊
    }␊
    ␊
    function _mount(target, anchor) {␊
    	this._fragment[this._fragment.i ? 'i' : 'm'](target, anchor || null);␊
    }␊
    ␊
    function _differs(a, b) {␊
    	return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');␊
    }␊
    ␊
    function noop() {}␊
    ␊
    function createSvgElement(name) {␊
    	return document.createElementNS('http://www.w3.org/2000/svg', name);␊
    }␊
    ␊
    function blankObject() {␊
    	return Object.create(null);␊
    }␊
    ␊
    function callAll(fns) {␊
    	while (fns && fns.length) fns.shift()();␊
    }␊
    export default CustomElement;new CustomElement({target:document.getElementById('belte-0'),hydrate:true,data:{}});new CustomElement({target:document.getElementById('belte-1'),hydrate:true,data:{}});</script><script>/* LogicElement.html generated by Svelte v2.16.1 */␊
    ␊
    function hours({ time }) {␊
    	return time.getHours();␊
    }␊
    ␊
    function minutes({ time }) {␊
    	return time.getMinutes();␊
    }␊
    ␊
    function seconds({ time }) {␊
    	return time.getSeconds();␊
    }␊
    ␊
    function data() {␊
    	return {␊
    		time: new Date()␊
    	};␊
    };␊
    ␊
    var methods = {␊
    	updateDate(_event) {␊
    		this.set({time: new Date()});␊
    	}␊
    };␊
    ␊
    function create_main_fragment(component, ctx) {␊
    	var div, span, text0, text1, text2, text3, text4, text5, text6, button, text7;␊
    ␊
    	function click_handler(event) {␊
    		component.updateDate(event);␊
    	}␊
    ␊
    	return {␊
    		c() {␊
    			div = createElement("div");␊
    			span = createElement("span");␊
    			text0 = createText("The time is: ");␊
    			text1 = createText(ctx.hours);␊
    			text2 = createText(":");␊
    			text3 = createText(ctx.minutes);␊
    			text4 = createText(":");␊
    			text5 = createText(ctx.seconds);␊
    			text6 = createText("\\n\\t");␊
    			button = createElement("button");␊
    			text7 = createText("update");␊
    			this.h()␊
    		},␊
    ␊
    		l(nodes) {␊
    			div = claimElement(nodes, "DIV", {}, false);␊
    			var div_nodes = children(div);␊
    ␊
    			span = claimElement(div_nodes, "SPAN", { class: true }, false);␊
    			var span_nodes = children(span);␊
    ␊
    			text0 = claimText(span_nodes, "The time is: ");␊
    			text1 = claimText(span_nodes, ctx.hours);␊
    			text2 = claimText(span_nodes, ":");␊
    			text3 = claimText(span_nodes, ctx.minutes);␊
    			text4 = claimText(span_nodes, ":");␊
    			text5 = claimText(span_nodes, ctx.seconds);␊
    			span_nodes.forEach(detachNode);␊
    			text6 = claimText(div_nodes, "\\n\\t");␊
    ␊
    			button = claimElement(div_nodes, "BUTTON", {}, false);␊
    			var button_nodes = children(button);␊
    ␊
    			text7 = claimText(button_nodes, "update");␊
    			button_nodes.forEach(detachNode);␊
    			div_nodes.forEach(detachNode);␊
    			this.h();␊
    		},␊
    ␊
    		h() {␊
    			span.className = "svelte-w26vqd";␊
    			addListener(button, "click", click_handler);␊
    		},␊
    ␊
    		m(target, anchor) {␊
    			insert(target, div, anchor);␊
    			append(div, span);␊
    			append(span, text0);␊
    			append(span, text1);␊
    			append(span, text2);␊
    			append(span, text3);␊
    			append(span, text4);␊
    			append(span, text5);␊
    			append(div, text6);␊
    			append(div, button);␊
    			append(button, text7);␊
    		},␊
    ␊
    		p(changed, ctx) {␊
    			if (changed.hours) {␊
    				setData(text1, ctx.hours);␊
    			}␊
    ␊
    			if (changed.minutes) {␊
    				setData(text3, ctx.minutes);␊
    			}␊
    ␊
    			if (changed.seconds) {␊
    				setData(text5, ctx.seconds);␊
    			}␊
    		},␊
    ␊
    		d(detach) {␊
    			if (detach) {␊
    				detachNode(div);␊
    			}␊
    ␊
    			removeListener(button, "click", click_handler);␊
    		}␊
    	};␊
    }␊
    ␊
    function LogicElement(options) {␊
    	init(this, options);␊
    	this._state = assign(data(), options.data);␊
    ␊
    	this._recompute({ time: 1 }, this._state);␊
    	this._intro = true;␊
    ␊
    	this._fragment = create_main_fragment(this, this._state);␊
    ␊
    	if (options.target) {␊
    		var nodes = children(options.target);␊
    		options.hydrate ? this._fragment.l(nodes) : this._fragment.c();␊
    		nodes.forEach(detachNode);␊
    		this._mount(options.target, options.anchor);␊
    	}␊
    }␊
    ␊
    assign(LogicElement.prototype, {␊
     	destroy: destroy,␊
     	get: get,␊
     	fire: fire,␊
     	on: on,␊
     	set: set,␊
     	_set: _set,␊
     	_stage: _stage,␊
     	_mount: _mount,␊
     	_differs: _differs␊
     });␊
    assign(LogicElement.prototype, methods);␊
    ␊
    LogicElement.prototype._recompute = function _recompute(changed, state) {␊
    	if (changed.time) {␊
    		if (this._differs(state.hours, (state.hours = hours(state)))) changed.hours = true;␊
    		if (this._differs(state.minutes, (state.minutes = minutes(state)))) changed.minutes = true;␊
    		if (this._differs(state.seconds, (state.seconds = seconds(state)))) changed.seconds = true;␊
    	}␊
    }␊
    ␊
    function createElement(name) {␊
    	return document.createElement(name);␊
    }␊
    ␊
    function createText(data) {␊
    	return document.createTextNode(data);␊
    }␊
    ␊
    function claimElement (nodes, name, attributes, svg) {␊
    	for (var i = 0; i < nodes.length; i += 1) {␊
    		var node = nodes[i];␊
    		if (node.nodeName === name) {␊
    			for (var j = 0; j < node.attributes.length; j += 1) {␊
    				var attribute = node.attributes[j];␊
    				if (!attributes[attribute.name]) node.removeAttribute(attribute.name);␊
    			}␊
    			return nodes.splice(i, 1)[0]; // TODO strip unwanted attributes␊
    		}␊
    	}␊
    ␊
    	return svg ? createSvgElement(name) : createElement(name);␊
    }␊
    ␊
    function children (element) {␊
    	return Array.from(element.childNodes);␊
    }␊
    ␊
    function claimText (nodes, data) {␊
    	for (var i = 0; i < nodes.length; i += 1) {␊
    		var node = nodes[i];␊
    		if (node.nodeType === 3) {␊
    			node.data = data;␊
    			return nodes.splice(i, 1)[0];␊
    		}␊
    	}␊
    ␊
    	return createText(data);␊
    }␊
    ␊
    function detachNode(node) {␊
    	node.parentNode.removeChild(node);␊
    }␊
    ␊
    function addListener(node, event, handler, options) {␊
    	node.addEventListener(event, handler, options);␊
    }␊
    ␊
    function insert(target, node, anchor) {␊
    	target.insertBefore(node, anchor);␊
    }␊
    ␊
    function append(target, node) {␊
    	target.appendChild(node);␊
    }␊
    ␊
    function setData(text, data) {␊
    	text.data = '' + data;␊
    }␊
    ␊
    function removeListener(node, event, handler, options) {␊
    	node.removeEventListener(event, handler, options);␊
    }␊
    ␊
    function init(component, options) {␊
    	component._handlers = blankObject();␊
    	component._slots = blankObject();␊
    	component._bind = options._bind;␊
    	component._staged = {};␊
    ␊
    	component.options = options;␊
    	component.root = options.root || component;␊
    	component.store = options.store || component.root.store;␊
    ␊
    	if (!options.root) {␊
    		component._beforecreate = [];␊
    		component._oncreate = [];␊
    		component._aftercreate = [];␊
    	}␊
    }␊
    ␊
    function assign(tar, src) {␊
    	for (var k in src) tar[k] = src[k];␊
    	return tar;␊
    }␊
    ␊
    function destroy(detach) {␊
    	this.destroy = noop;␊
    	this.fire('destroy');␊
    	this.set = noop;␊
    ␊
    	this._fragment.d(detach !== false);␊
    	this._fragment = null;␊
    	this._state = {};␊
    }␊
    ␊
    function get() {␊
    	return this._state;␊
    }␊
    ␊
    function fire(eventName, data) {␊
    	var handlers =␊
    		eventName in this._handlers && this._handlers[eventName].slice();␊
    	if (!handlers) return;␊
    ␊
    	for (var i = 0; i < handlers.length; i += 1) {␊
    		var handler = handlers[i];␊
    ␊
    		if (!handler.__calling) {␊
    			try {␊
    				handler.__calling = true;␊
    				handler.call(this, data);␊
    			} finally {␊
    				handler.__calling = false;␊
    			}␊
    		}␊
    	}␊
    }␊
    ␊
    function on(eventName, handler) {␊
    	var handlers = this._handlers[eventName] || (this._handlers[eventName] = []);␊
    	handlers.push(handler);␊
    ␊
    	return {␊
    		cancel: function() {␊
    			var index = handlers.indexOf(handler);␊
    			if (~index) handlers.splice(index, 1);␊
    		}␊
    	};␊
    }␊
    ␊
    function set(newState) {␊
    	this._set(assign({}, newState));␊
    	if (this.root._lock) return;␊
    	flush(this.root);␊
    }␊
    ␊
    function _set(newState) {␊
    	var oldState = this._state,␊
    		changed = {},␊
    		dirty = false;␊
    ␊
    	newState = assign(this._staged, newState);␊
    	this._staged = {};␊
    ␊
    	for (var key in newState) {␊
    		if (this._differs(newState[key], oldState[key])) changed[key] = dirty = true;␊
    	}␊
    	if (!dirty) return;␊
    ␊
    	this._state = assign(assign({}, oldState), newState);␊
    	this._recompute(changed, this._state);␊
    	if (this._bind) this._bind(changed, this._state);␊
    ␊
    	if (this._fragment) {␊
    		this.fire("state", { changed: changed, current: this._state, previous: oldState });␊
    		this._fragment.p(changed, this._state);␊
    		this.fire("update", { changed: changed, current: this._state, previous: oldState });␊
    	}␊
    }␊
    ␊
    function _stage(newState) {␊
    	assign(this._staged, newState);␊
    }␊
    ␊
    function _mount(target, anchor) {␊
    	this._fragment[this._fragment.i ? 'i' : 'm'](target, anchor || null);␊
    }␊
    ␊
    function _differs(a, b) {␊
    	return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');␊
    }␊
    ␊
    function createSvgElement(name) {␊
    	return document.createElementNS('http://www.w3.org/2000/svg', name);␊
    }␊
    ␊
    function blankObject() {␊
    	return Object.create(null);␊
    }␊
    ␊
    function noop() {}␊
    ␊
    function flush(component) {␊
    	component._lock = true;␊
    	callAll(component._beforecreate);␊
    	callAll(component._oncreate);␊
    	callAll(component._aftercreate);␊
    	component._lock = false;␊
    }␊
    ␊
    function callAll(fns) {␊
    	while (fns && fns.length) fns.shift()();␊
    }␊
    export default LogicElement;new LogicElement({target:document.getElementById('belte-2'),hydrate:true,data:{}});</script></body></html>`
